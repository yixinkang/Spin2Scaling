#ifndef MESH_H
#define MESH_H

#define FACE_COUNT 4
#define DUAL_EDGE_LENGTH 1.0000000000000002
#define VALUES_IN_BLOCK 12
#define INDICES_PER_BLOCK 48
const Vector3 BLOCK_WIDTH = Vector3(2.8284271247461903, 2.8284271247461903, 2.8284271247461903); // dimensions of unit block
constexpr double BLOCK_WIDTH_X = 2.8284271247461903; // dimensions of unit block
constexpr double BLOCK_WIDTH_Y = 2.8284271247461903; // dimensions of unit block
constexpr double BLOCK_WIDTH_Z = 2.8284271247461903; // dimensions of unit block
const ddouble VOLUME = 1.8856180831641269; // volume of body elements
const bool IS_3D = true; // 3-dimensional

__constant__ double3 d_localPos[VALUES_IN_BLOCK] = {
	{ 0.35355339059327295, 1.0606601717798207, 2.4748737341529159 },
	{2.4748737341529159, 0.35355339059327295, 1.0606601717798207 },
	{2.4748737341529159, 1.0606601717798207, 0.35355339059327295 },
	{2.4748737341529159, 1.0606601717798207, 1.7677669529663687 },
	{2.4748737341529159, 1.7677669529663687, 1.0606601717798207 },
	{0.35355339059327295, 2.4748737341529159, 1.0606601717798207 },
	{1.0606601717798207, 2.4748737341529159, 0.35355339059327295 },
	{1.0606601717798207, 2.4748737341529159, 1.7677669529663687 },
	{1.7677669529663687, 2.4748737341529159, 1.0606601717798207 },
	{1.0606601717798207, 0.35355339059327295, 2.4748737341529159 },
	 {1.0606601717798207, 1.7677669529663687, 2.4748737341529159 },
	 {1.7677669529663687, 1.0606601717798207, 2.4748737341529159 } };

double3 getLocalPos(int dualZeroCellIndex)
{
	double3 pos[VALUES_IN_BLOCK];
	pos[0] = { 0.35355339059327295, 1.0606601717798207, 2.4748737341529159 };
	pos[1] = {2.4748737341529159, 0.35355339059327295, 1.0606601717798207 };
	pos[2] = {2.4748737341529159, 1.0606601717798207, 0.35355339059327295 };
	pos[3] = {2.4748737341529159, 1.0606601717798207, 1.7677669529663687 };
	pos[4] = {2.4748737341529159, 1.7677669529663687, 1.0606601717798207 };
	pos[5] = {0.35355339059327295, 2.4748737341529159, 1.0606601717798207 };
	pos[6] = {1.0606601717798207, 2.4748737341529159, 0.35355339059327295 };
	pos[7] = {1.0606601717798207, 2.4748737341529159, 1.7677669529663687 };
	pos[8] = {1.7677669529663687, 2.4748737341529159, 1.0606601717798207 };
	pos[9] = {1.0606601717798207, 0.35355339059327295, 2.4748737341529159 };
	pos[10] = {1.0606601717798207, 1.7677669529663687, 2.4748737341529159 };
	pos[11] = {1.7677669529663687, 1.0606601717798207, 2.4748737341529159 };

	return pos[dualZeroCellIndex];
}
ddouble getLaplacian(Buffer<int4>& ind, Buffer<ddouble>& hodges, const int nx, const int ny, const int nz) // nx, ny, nz in bytes
{
	ind.resize(INDICES_PER_BLOCK);
	// Dual node idx:  0
	ind[0] = make_int4(0, 0, 0, 9);
	ind[1] = make_int4(0, 0, 0, 10);
	ind[2] = make_int4(-1, 0, 1, 2);
	ind[3] = make_int4(-1, 0, 0, 3);
	// Dual node idx:  1
	ind[4] = make_int4(0, 0, 0, 2);
	ind[5] = make_int4(0, 0, 0, 3);
	ind[6] = make_int4(1, -1, 0, 5);
	ind[7] = make_int4(0, -1, 0, 8);
	// Dual node idx:  2
	ind[8] = make_int4(0, 0, 0, 1);
	ind[9] = make_int4(0, 0, 0, 4);
	ind[10] = make_int4(1, 0, -1, 0);
	ind[11] = make_int4(0, 0, -1, 11);
	// Dual node idx:  3
	ind[12] = make_int4(0, 0, 0, 1);
	ind[13] = make_int4(0, 0, 0, 4);
	ind[14] = make_int4(1, 0, 0, 0);
	ind[15] = make_int4(0, 0, 0, 11);
	// Dual node idx:  4
	ind[16] = make_int4(0, 0, 0, 2);
	ind[17] = make_int4(0, 0, 0, 3);
	ind[18] = make_int4(1, 0, 0, 5);
	ind[19] = make_int4(0, 0, 0, 8);
	// Dual node idx:  5
	ind[20] = make_int4(0, 0, 0, 6);
	ind[21] = make_int4(0, 0, 0, 7);
	ind[22] = make_int4(-1, 1, 0, 1);
	ind[23] = make_int4(-1, 0, 0, 4);
	// Dual node idx:  6
	ind[24] = make_int4(0, 0, 0, 5);
	ind[25] = make_int4(0, 0, 0, 8);
	ind[26] = make_int4(0, 1, -1, 9);
	ind[27] = make_int4(0, 0, -1, 10);
	// Dual node idx:  7
	ind[28] = make_int4(0, 0, 0, 5);
	ind[29] = make_int4(0, 0, 0, 8);
	ind[30] = make_int4(0, 1, 0, 9);
	ind[31] = make_int4(0, 0, 0, 10);
	// Dual node idx:  8
	ind[32] = make_int4(0, 0, 0, 6);
	ind[33] = make_int4(0, 0, 0, 7);
	ind[34] = make_int4(0, 1, 0, 1);
	ind[35] = make_int4(0, 0, 0, 4);
	// Dual node idx:  9
	ind[36] = make_int4(0, 0, 0, 0);
	ind[37] = make_int4(0, 0, 0, 11);
	ind[38] = make_int4(0, -1, 1, 6);
	ind[39] = make_int4(0, -1, 0, 7);
	// Dual node idx:  10
	ind[40] = make_int4(0, 0, 0, 0);
	ind[41] = make_int4(0, 0, 0, 11);
	ind[42] = make_int4(0, 0, 1, 6);
	ind[43] = make_int4(0, 0, 0, 7);
	// Dual node idx:  11
	ind[44] = make_int4(0, 0, 0, 9);
	ind[45] = make_int4(0, 0, 0, 10);
	ind[46] = make_int4(0, 0, 1, 2);
	ind[47] = make_int4(0, 0, 0, 3);

	hodges.resize(INDICES_PER_BLOCK);
	hodges[0] = 1.4999999999999996;
	hodges[1] = 1.4999999999999996;
	hodges[2] = 1.5000000000000004;
	hodges[3] = 1.5000000000000011;
	hodges[4] = 1.4999999999999996;
	hodges[5] = 1.4999999999999996;
	hodges[6] = 1.5000000000000004;
	hodges[7] = 1.5000000000000011;
	hodges[8] = 1.5000000000000004;
	hodges[9] = 1.4999999999999996;
	hodges[10] = 1.4999999999999996;
	hodges[11] = 1.5000000000000011;
	hodges[12] = 1.5000000000000011;
	hodges[13] = 1.4999999999999996;
	hodges[14] = 1.4999999999999993;
	hodges[15] = 1.5000000000000011;
	hodges[16] = 1.4999999999999996;
	hodges[17] = 1.4999999999999993;
	hodges[18] = 1.5000000000000002;
	hodges[19] = 1.5000000000000011;
	hodges[20] = 1.5000000000000004;
	hodges[21] = 1.5000000000000002;
	hodges[22] = 1.4999999999999996;
	hodges[23] = 1.4999999999999996;
	hodges[24] = 1.4999999999999996;
	hodges[25] = 1.4999999999999996;
	hodges[26] = 1.5000000000000004;
	hodges[27] = 1.5000000000000011;
	hodges[28] = 1.4999999999999996;
	hodges[29] = 1.4999999999999993;
	hodges[30] = 1.5000000000000002;
	hodges[31] = 1.5000000000000011;
	hodges[32] = 1.5000000000000011;
	hodges[33] = 1.5000000000000011;
	hodges[34] = 1.4999999999999996;
	hodges[35] = 1.4999999999999993;
	hodges[36] = 1.4999999999999996;
	hodges[37] = 1.5000000000000004;
	hodges[38] = 1.5000000000000002;
	hodges[39] = 1.4999999999999996;
	hodges[40] = 1.4999999999999996;
	hodges[41] = 1.5000000000000011;
	hodges[42] = 1.5000000000000011;
	hodges[43] = 1.4999999999999993;
	hodges[44] = 1.5000000000000011;
	hodges[45] = 1.5000000000000011;
	hodges[46] = 1.4999999999999996;
	hodges[47] = 1.4999999999999993;

	return 1.5000000000000011;
}

#endif // MESH_H
